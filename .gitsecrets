# Git Secrets patterns for Flame_Of_Styx_bot

# Telegram Bot Tokens
[0-9]{8,10}:[A-Za-z0-9_-]{35}
[0-9]{8,10}:[A-Za-z0-9_-]{35}

# Database URLs
postgresql://[^:]+:[^@]+@[^/]+/[^/]+
mysql://[^:]+:[^@]+@[^/]+/[^/]+
sqlite://[^/]+

# Redis URLs
redis://[^:]+:[^@]+@[^/]+
rediss://[^:]+:[^@]+@[^/]+

# API Keys
api[_-]?key[_-]?[A-Za-z0-9]{20,}
secret[_-]?key[_-]?[A-Za-z0-9]{20,}
access[_-]?token[_-]?[A-Za-z0-9]{20,}

# JWT Tokens
eyJ[A-Za-z0-9_-]*\.[A-Za-z0-9_-]*\.[A-Za-z0-9_-]*

# Private Keys
-----BEGIN (RSA |DSA |EC |OPENSSH )?PRIVATE KEY-----
-----BEGIN PGP PRIVATE KEY BLOCK-----

# Passwords
password[_-]?[=:]\s*[A-Za-z0-9!@#$%^&*()_+-=]{8,}
passwd[_-]?[=:]\s*[A-Za-z0-9!@#$%^&*()_+-=]{8,}

# Admin IDs (Telegram)
admin[_-]?id[_-]?[=:]\s*[0-9]{8,12}

# Database passwords
db[_-]?password[_-]?[=:]\s*[A-Za-z0-9!@#$%^&*()_+-=]{8,}

# Webhook secrets
webhook[_-]?secret[_-]?[=:]\s*[A-Za-z0-9_-]{20,}

# OAuth secrets
client[_-]?secret[_-]?[=:]\s*[A-Za-z0-9_-]{20,}

# AWS credentials
aws[_-]?access[_-]?key[_-]?id[_-]?[=:]\s*[A-Za-z0-9]{20,}
aws[_-]?secret[_-]?access[_-]?key[_-]?[=:]\s*[A-Za-z0-9]{40,}

# Docker registry passwords
docker[_-]?password[_-]?[=:]\s*[A-Za-z0-9!@#$%^&*()_+-=]{8,}

# GitHub tokens
ghp_[A-Za-z0-9]{36}
gho_[A-Za-z0-9]{36}
ghu_[A-Za-z0-9]{36}
ghs_[A-Za-z0-9]{36}
ghr_[A-Za-z0-9]{36}

# Slack tokens
xoxb-[0-9]{11}-[0-9]{11}-[A-Za-z0-9]{24}
xoxp-[0-9]{11}-[0-9]{11}-[A-Za-z0-9]{24}

# Discord tokens
[A-Za-z0-9]{24}\.[A-Za-z0-9]{6}\.[A-Za-z0-9]{27}

# Generic secrets (very specific patterns - only real secrets)
# Note: These patterns are disabled for test values
# secret[_-]?[=:]\s*[A-Za-z0-9!@#$%^&*()_+-=]{30,}
# token[_-]?[=:]\s*[A-Za-z0-9!@#$%^&*()_+-=]{30,}

# ALLOWED PATTERNS (Test values and documentation)
# Test bot tokens
test_token_[A-Za-z0-9_]+
BOT_TOKEN=123456789:test_token_
BOT_TOKEN: 123456789:test_token_
bot = Bot\(token=config\.bot_token

# Test admin IDs
ADMIN_IDS=123456789
ADMIN_IDS: 123456789

# Test database paths
DB_PATH=test\.db
DB_PATH: test\.db

# Test Redis URLs
REDIS_URL=redis://localhost:6379/0
REDIS_URL: redis://localhost:6379/0

# Test environment variables
echo "BOT_TOKEN=123456789:test_token_
echo "ADMIN_IDS=123456789"
echo "DB_PATH=test\.db"
echo "REDIS_URL=redis://localhost:6379/0"

# Workflow-specific patterns
echo "BOT_TOKEN=123456789:test_token_123456789"
git secrets --add --allowed 'BOT_TOKEN=123456789:test_token_'
git secrets --add --allowed 'BOT_TOKEN: 123456789:test_token_'
git secrets --add --allowed 'echo "BOT_TOKEN=123456789:test_token_'

# Specific workflow patterns that were detected
echo "BOT_TOKEN=123456789:test_token_123456789" >> $GITHUB_ENV
git secrets --add --allowed 'echo "BOT_TOKEN=123456789:test_token_123456789"'
