# ๐ Hot-Reload ะดะปั ะฝะฐัััะพะตะบ ะฑะพัะฐ

ะกะธััะตะผะฐ ะฐะฒัะพะผะฐัะธัะตัะบะพะณะพ ะพะฑะฝะพะฒะปะตะฝะธั ะบะพะฝัะธะณััะฐัะธะธ ะฑะตะท ะฟะตัะตะทะฐะฟััะบะฐ ะฑะพัะฐ.

## โจ ะะพะทะผะพะถะฝะพััะธ

- **ะะฒัะพะผะฐัะธัะตัะบะพะต ะพะฑะฝะพะฒะปะตะฝะธะต** ะปะธะผะธัะพะฒ ะธะท ัะฐะนะปะฐ `limits.json`
- **ะะพะฝะธัะพัะธะฝะณ ะธะทะผะตะฝะตะฝะธะน** ะฒ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ
- **ะะฐะปะธะดะฐัะธั** ะฝะพะฒัั ะทะฝะฐัะตะฝะธะน
- **ะฃะฒะตะดะพะผะปะตะฝะธั ะฐะดะผะธะฝะธัััะฐัะพัะพะฒ** ะพะฑ ะธะทะผะตะฝะตะฝะธัั
- **ะัะธะฝัะดะธัะตะปัะฝะฐั ะฟะตัะตะทะฐะณััะทะบะฐ** ัะตัะตะท ะบะพะผะฐะฝะดั

## ๐ ะะฐะบ ะธัะฟะพะปัะทะพะฒะฐัั

### 1. ะะฒัะพะผะฐัะธัะตัะบะพะต ะพะฑะฝะพะฒะปะตะฝะธะต

ะัะพััะพ ะพััะตะดะฐะบัะธััะนัะต ัะฐะนะป `limits.json`:

```json
{
  "max_messages_per_minute": 15,
  "max_links_per_message": 5,
  "ban_duration_hours": 48,
  "suspicion_threshold": 0.3
}
```

ะะทะผะตะฝะตะฝะธั ะฟัะธะผะตะฝัััั ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฒ ัะตัะตะฝะธะต 2 ัะตะบัะฝะด!

### 2. ะะพะผะฐะฝะดั ะฐะดะผะธะฝะธัััะฐัะพัะฐ

#### `/reload_limits`
ะัะธะฝัะดะธัะตะปัะฝะพ ะฟะตัะตะทะฐะณััะถะฐะตั ะปะธะผะธัั ะธะท ัะฐะนะปะฐ:

```
/reload_limits
```

**ะัะฒะตั:**
```
๐ ะะธะผะธัั ะฟะตัะตะทะฐะณััะถะตะฝั!

๐ ะขะตะบััะธะต ะปะธะผะธัั:
โข ะกะพะพะฑัะตะฝะธะน ะฒ ะผะธะฝััั: 15
โข ะกััะปะพะบ ะฒ ัะพะพะฑัะตะฝะธะธ: 5
โข ะัะตะผั ะฑะปะพะบะธัะพะฒะบะธ: 48 ัะฐัะพะฒ
โข ะะพัะพะณ ะฟะพะดะพะทัะธัะตะปัะฝะพััะธ: 0.3

โ ะะทะผะตะฝะตะฝะธั ะฟัะธะผะตะฝะตะฝั ะฝะตะผะตะดะปะตะฝะฝะพ!
```

#### `/setlimit` (ั hot-reload)
ะะทะผะตะฝัะตั ะปะธะผะธั ะธ ะฟัะธะผะตะฝัะตั ะธะทะผะตะฝะตะฝะธั ะฝะตะผะตะดะปะตะฝะฝะพ:

```
/setlimit threshold 0.4
```

**ะัะฒะตั:**
```
โ ะะธะผะธั ะพะฑะฝะพะฒะปะตะฝ!

๐ threshold ะธะทะผะตะฝะตะฝ ะฝะฐ 0.4

๐ ะะทะผะตะฝะตะฝะธั ะฟัะธะผะตะฝะตะฝั ะฝะตะผะตะดะปะตะฝะฝะพ ะฑะปะฐะณะพะดะฐัั hot-reload!
```

### 3. ะฃะฒะตะดะพะผะปะตะฝะธั ะพะฑ ะธะทะผะตะฝะตะฝะธัั

ะัะธ ะธะทะผะตะฝะตะฝะธะธ ัะฐะนะปะฐ `limits.json` ะฒัะต ะฐะดะผะธะฝะธัััะฐัะพัั ะฟะพะปััะฐั ัะฒะตะดะพะผะปะตะฝะธะต:

```
๐ ะะธะผะธัั ะพะฑะฝะพะฒะปะตะฝั ะฐะฒัะพะผะฐัะธัะตัะบะธ!

โข max_messages_per_minute: 10 โ 15
โข max_links_per_message: 3 โ 5
โข ban_duration_hours: 24 โ 48
โข suspicion_threshold: 0.2 โ 0.3

โ ะะทะผะตะฝะตะฝะธั ะฒัััะฟะธะปะธ ะฒ ัะธะปั ะฝะตะผะตะดะปะตะฝะฝะพ
```

## ๐ง ะขะตัะฝะธัะตัะบะธะต ะดะตัะฐะปะธ

### ะััะธัะตะบัััะฐ

```
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
โ   limits.json   โโโโโถโ  ConfigWatcher   โโโโโถโ  LimitsService  โ
โ   (ัะฐะนะป)        โ    โ  (ะผะพะฝะธัะพัะธะฝะณ)    โ    โ  (ะบััะธัะพะฒะฐะฝะธะต)  โ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
                                โ
                                โผ
                       โโโโโโโโโโโโโโโโโโโโ
                       โ  LimitsHotReload โ
                       โ  (ัะฒะตะดะพะผะปะตะฝะธั)   โ
                       โโโโโโโโโโโโโโโโโโโโ
```

### ะะพะผะฟะพะฝะตะฝัั

1. **ConfigWatcher** - ะผะพะฝะธัะพัะธั ะธะทะผะตะฝะตะฝะธั ัะฐะนะปะพะฒ
2. **LimitsHotReload** - ะพะฑัะฐะฑะฐััะฒะฐะตั ะธะทะผะตะฝะตะฝะธั ะปะธะผะธัะพะฒ
3. **LimitsService** - ะบััะธััะตั ะธ ะฟัะตะดะพััะฐะฒะปัะตั ะปะธะผะธัั

### ะะฐะปะธะดะฐัะธั

ะกะธััะตะผะฐ ะฟัะพะฒะตััะตั:
- **ะขะธะฟั ะดะฐะฝะฝัั** (int, float)
- **ะะธะฐะฟะฐะทะพะฝั ะทะฝะฐัะตะฝะธะน** (0 < threshold <= 1)
- **ะะฑัะทะฐัะตะปัะฝัะต ะฟะพะปั** (ะฒัะต 4 ะปะธะผะธัะฐ)
- **JSON ัะพัะผะฐั** ัะฐะนะปะฐ

### ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ

- **ะะตะฒะตัะฝัะน JSON** - ัะฒะตะดะพะผะปะตะฝะธะต ะฐะดะผะธะฝะธัััะฐัะพัะพะฒ
- **ะะตะบะพััะตะบัะฝัะต ะทะฝะฐัะตะฝะธั** - ะพัะบะฐั ะบ ะฟัะตะดัะดััะธะผ ะฝะฐัััะพะนะบะฐะผ
- **ะััััััะฒะธะต ัะฐะนะปะฐ** - ะธัะฟะพะปัะทะพะฒะฐะฝะธะต ะทะฝะฐัะตะฝะธะน ะฟะพ ัะผะพะปัะฐะฝะธั

## ๐ ะัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั

### ะกัะตะฝะฐัะธะน 1: ะะทะผะตะฝะตะฝะธะต ะฟะพัะพะณะฐ ะฟะพะดะพะทัะธัะตะปัะฝะพััะธ

1. ะัะบัะพะนัะต `limits.json`
2. ะะทะผะตะฝะธัะต `suspicion_threshold` ั `0.2` ะฝะฐ `0.4`
3. ะกะพััะฐะฝะธัะต ัะฐะนะป
4. ะงะตัะตะท 2 ัะตะบัะฝะดั ะฒัะต ะฐะดะผะธะฝะธัััะฐัะพัั ะฟะพะปััะฐั ัะฒะตะดะพะผะปะตะฝะธะต
5. ะะพะฒัะน ะฟะพัะพะณ ะฟัะธะผะตะฝัะตััั ะฝะตะผะตะดะปะตะฝะฝะพ

### ะกัะตะฝะฐัะธะน 2: ะะฐััะพะฒะพะต ะธะทะผะตะฝะตะฝะธะต ะปะธะผะธัะพะฒ

1. ะััะตะดะฐะบัะธััะนัะต ะฝะตัะบะพะปัะบะพ ะทะฝะฐัะตะฝะธะน ะฒ `limits.json`
2. ะกะพััะฐะฝะธัะต ัะฐะนะป
3. ะกะธััะตะผะฐ ะฟะพะบะฐะถะตั ะฒัะต ะธะทะผะตะฝะตะฝะธั ะฒ ัะฒะตะดะพะผะปะตะฝะธะธ
4. ะัะต ะธะทะผะตะฝะตะฝะธั ะฟัะธะผะตะฝััััั ะพะดะฝะพะฒัะตะผะตะฝะฝะพ

### ะกัะตะฝะฐัะธะน 3: ะัะธะฝัะดะธัะตะปัะฝะฐั ะฟะตัะตะทะฐะณััะทะบะฐ

1. ะัะฟะพะปัะทัะนัะต ะบะพะผะฐะฝะดั `/reload_limits`
2. ะกะธััะตะผะฐ ะฟะตัะตะทะฐะณััะทะธั ะปะธะผะธัั ะธะท ัะฐะนะปะฐ
3. ะะพะบะฐะถะตั ัะตะบััะธะต ะทะฝะฐัะตะฝะธั

## โ๏ธ ะะฐะถะฝัะต ะทะฐะผะตัะฐะฝะธั

### ะะตะทะพะฟะฐัะฝะพััั
- ะคะฐะนะป `limits.json` **ะะ** ะพััะปะตะถะธะฒะฐะตััั Git
- ะะฐะถะดัะน ะฐะดะผะธะฝะธัััะฐัะพั ะผะพะถะตั ะธะผะตัั ัะฒะพะธ ะฝะฐัััะพะนะบะธ
- ะะทะผะตะฝะตะฝะธั ะฟัะธะผะตะฝััััั ัะพะปัะบะพ ะปะพะบะฐะปัะฝะพ

### ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั
- ะะพะฝะธัะพัะธะฝะณ ะฟัะพะธััะพะดะธั ะบะฐะถะดัะต 2 ัะตะบัะฝะดั
- ะะธะฝะธะผะฐะปัะฝะฐั ะฝะฐะณััะทะบะฐ ะฝะฐ ัะธััะตะผั
- ะััะธัะพะฒะฐะฝะธะต ะฟัะตะดะพัะฒัะฐัะฐะตั ัะฐัััะต ััะตะฝะธั ัะฐะนะปะฐ

### ะกะพะฒะผะตััะธะผะพััั
- ะะฐะฑะพัะฐะตั ั ัััะตััะฒัััะธะผะธ ะบะพะผะฐะฝะดะฐะผะธ `/setlimit`
- ะะต ััะตะฑัะตั ะธะทะผะตะฝะตะฝะธะน ะฒ ะบะพะดะต ะฑะพัะฐ
- ะะฑัะฐัะฝะฐั ัะพะฒะผะตััะธะผะพััั ั ัััะฝัะผ ัะฟัะฐะฒะปะตะฝะธะตะผ

## ๐ ะัะปะฐะดะบะฐ

### ะะพะณะธ
```
INFO - ConfigWatcher ะทะฐะฟััะตะฝ ะดะปั ัะฐะนะปะฐ: limits.json
INFO - ะะฑะฝะฐััะถะตะฝั ะธะทะผะตะฝะตะฝะธั ะฒ ัะฐะนะปะต: limits.json
INFO - ะะธะผะธัั ััะฟะตัะฝะพ ะพะฑะฝะพะฒะปะตะฝั: {'max_messages_per_minute': 15, ...}
```

### ะัะพะฒะตัะบะฐ ััะฐัััะฐ
ะัะฟะพะปัะทัะนัะต ะบะพะผะฐะฝะดั `/setlimits` ะดะปั ะฟัะพัะผะพััะฐ ัะตะบััะธั ะปะธะผะธัะพะฒ.

### ะัะธะฝัะดะธัะตะปัะฝะฐั ะฟะตัะตะทะฐะณััะทะบะฐ
ะัะปะธ ััะพ-ัะพ ะฟะพัะปะพ ะฝะต ัะฐะบ, ะธัะฟะพะปัะทัะนัะต `/reload_limits`.

## ๐ฎ ะะปะฐะฝั ัะฐะทะฒะธัะธั

- [ ] Hot-reload ะดะปั ะดััะณะธั ะบะพะฝัะธะณััะฐัะธะพะฝะฝัั ัะฐะนะปะพะฒ
- [ ] ะะตะฑ-ะธะฝัะตััะตะนั ะดะปั ัะฟัะฐะฒะปะตะฝะธั ะฝะฐัััะพะนะบะฐะผะธ
- [ ] ะััะพัะธั ะธะทะผะตะฝะตะฝะธะน ะปะธะผะธัะพะฒ
- [ ] ะัะบะฐั ะบ ะฟัะตะดัะดััะธะผ ะฝะฐัััะพะนะบะฐะผ
- [ ] ะฃะฒะตะดะพะผะปะตะฝะธั ะพ ะฝะตะบะพััะตะบัะฝัั ะทะฝะฐัะตะฝะธัั ะฒ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ
